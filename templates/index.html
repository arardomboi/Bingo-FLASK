<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Night Bingo</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color:#0a0a0a; color:white; text-align:center; margin:0; padding:15px; user-select:none;}
  h1 { font-size:1.6em; color:#ff66cc; margin-bottom:15px;}
  .board { display:grid; grid-template-columns:repeat(5, 1fr); gap:6px; max-width:95vw; margin:0 auto; }
  button { background-color:#1c1c1e; color:white; border:2px solid #ff66cc; border-radius:10px; padding:8px; font-size:0.8em; cursor:pointer; min-height:70px; word-wrap:break-word; -webkit-tap-highlight-color:transparent;}
  button.active { background-color:#ff66cc; color:#1c1c1e; transform:scale(0.97);}
  button:focus { outline:none;}
  footer { margin-top:15px; color:#aaa; font-size:0.8em;}
</style>
</head>
<body>

<h1>ðŸŽ“ Student Night Bingo ðŸŽ‰</h1>

<div class="board"></div>

<footer>
  Tap squares to mark them off! (updates for everyone)
</footer>

<!-- Socket.IO client (served from CDN). Version should match server compatibility. -->
<script src="https://cdn.socket.io/4.6.1/socket.io.min.js" integrity="" crossorigin="anonymous"></script>
<script>
  const socket = io();

  // Create a button element for an item
  function makeButton(label, index, active) {
    const btn = document.createElement('button');
    btn.textContent = label;
    btn.dataset.index = index;
    if (active) btn.classList.add('active');
    btn.addEventListener('click', () => {
      // Ask server to toggle â€” server will broadcast the update to everyone
      socket.emit('toggle', { index: index });
    });
    return btn;
  }

  // Render full board from labels/state arrays
  function renderBoard(labels, state) {
    const board = document.querySelector('.board');
    board.innerHTML = '';
    labels.forEach((label, i) => {
      board.appendChild(makeButton(label, i, !!state[i]));
    });
  }

  // On initial connection the server will send the current board
  socket.on('init', data => {
    renderBoard(data.labels, data.state);
  });

  // When any client toggles a square, server broadcasts 'update'
  socket.on('update', data => {
    const idx = data.index;
    const state = data.state;
    const btn = document.querySelector(`button[data-index="${idx}"]`);
    if (btn) {
      btn.classList.toggle('active', !!state);
    }
  });

  // Fallback: if the page already had static buttons, convert them (not expected here)
  // Not needed because server sends init on connect.
</script>

</body>
</html>
