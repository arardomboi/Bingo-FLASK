:root{
  --bg:#040405; /* very dark */
  --card:#121214; /* card background */
  --accent:#ffffff;
  --muted:#9aa0a6;
  --text:#ffffff;
  --user-color:#ffffff; /* default, can be overridden per button */
}

/* Mobile-first, compact, high-contrast styles */
html,body{height:100%; width:100%; margin:0; padding:0; overflow:hidden;}
body {
  font-family: Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
  text-align:center;
  margin:0;
  padding:3px;
  -webkit-font-smoothing:antialiased;
  user-select:none;
  display:flex;
  flex-direction:column;
  gap:2px;
  box-sizing:border-box;
}

h1 {
  font-size:clamp(0.8rem, 2.5vw, 1rem);
  color:var(--accent);
  margin:4px 0 6px 0;
  line-height:1;
  font-weight:600;
}

/* Board is always 5x5, scaling everything down on very small screens to fit */
.board {
  display:grid;
  grid-template-columns:repeat(5, 1fr);
  gap:clamp(1px, 0.3vw, 2px);
  width:min(92vw, 92vh); /* take minimum of width or height to ensure it fits */
  max-width:none; /* don't limit max width */
  margin:0 auto;
  aspect-ratio:1 / 1; /* keep board square */
  padding:clamp(1px, 0.2vw, 2px);
}

/* Buttons scale down proportionally with the board */
button {
  background:var(--card);
  color:var(--text);
  border:2px solid rgba(255,255,255,0.28);
  border-radius:4px;
  padding:clamp(2px, 1.5vw, 6px);
  font-size:clamp(9px, 5vw, 16px); /* scales text to nearly fill box */
  cursor:pointer;
  aspect-ratio:1; /* make buttons square */
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  line-height:1.2;
  white-space:normal;
  word-break:break-word;
  word-wrap:break-word;
  overflow-wrap:break-word;
  hyphens:none;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  /* Only animate transform (tap feedback). Background/color changes are handled explicitly
     so we can control activation fade vs instant deactivation. */
  transition: transform .06s ease;
  position:relative; /* allow ::after pulse */
  min-width:0; /* allow button to shrink below content size */
  min-height:0;
}

/* Keyframes for a small fade-in when a button becomes active */
@keyframes activeFade {
  0% {
    opacity: 0.3;
  }
  100% {
    opacity: 1;
  }
}

/* When a button becomes active, fade in. Background/color are set inline by JS. */
button.active{
  animation: activeFade .14s ease forwards;
  transform:scale(0.985);
  border-color:rgba(0,0,0,0.2);
  box-shadow:0 2px 6px rgba(0,0,0,0.45);
}

/* Edge pulse uses a pseudo element so it doesn't affect layout */
button::after{
  content:'';
  position:absolute;
  left:0; right:0; top:0; bottom:0;
  border-radius:8px;
  pointer-events:none;
  opacity:0;
}

@keyframes edgePulse{
  0%{ box-shadow: 0 0 0 0 rgba(255,255,255,0.9); opacity:1 }
  100%{ box-shadow: 0 0 18px 8px rgba(255,255,255,0); opacity:0 }
}

/* Add pulse class on remote activations to draw attention to the edge */
button.pulse::after{
  animation: edgePulse .7s ease-out forwards;
}

button:active{transform:scale(0.98);} /* quick tap feedback */

button:focus-visible{outline:2px solid rgba(255,255,255,0.14); outline-offset:2px}

/* Brief blocked feedback when a user attempts to press a claimed box */
.blocked{
  animation: blockedShake .7s ease;
  outline:3px solid rgba(255,0,0,0.85);
}

@keyframes blockedShake{
  0%{ transform: translateX(0) }
  20%{ transform: translateX(-6px) }
  40%{ transform: translateX(6px) }
  60%{ transform: translateX(-4px) }
  80%{ transform: translateX(4px) }
  100%{ transform: translateX(0) }
}

footer{margin-top:auto; color:var(--muted); font-size:clamp(7px, 1.2vw, 10px); padding:2px 0}

.footer-text{display:inline-block; margin-right:clamp(6px, 1vw, 8px)}
.footer-controls{display:inline-block}

/* Small floating sync button for forcing refresh across clients */
#force-refresh{
  appearance:none;
  -webkit-appearance:none;
  border:1px solid rgba(255,255,255,0.06);
  background:rgba(255,255,255,0.03);
  color:var(--text);
  padding:clamp(4px, 1vw, 6px) clamp(6px, 1.5vw, 8px);
  border-radius:8px;
  font-size:clamp(10px, 1.8vw, 12px);
  cursor:pointer;
}

#force-refresh:active{transform:scale(0.98)}

/* Optional: make it fixed bottom-right on small screens for easy access */
@media (max-width:520px){
  .footer-controls{position:fixed; right:12px; bottom:12px}
  footer{padding-bottom:46px}
}

/* Remove old media queries; 5x5 is now maintained on all screen sizes */

/* ============ COLOR PICKER MODAL ============ */

.modal{
  display:none;
  position:fixed;
  top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,0.8);
  z-index:9999;
  align-items:center;
  justify-content:center;
  flex-direction:column;
}

.modal-content{
  background:var(--card);
  border:1px solid rgba(255,255,255,0.12);
  border-radius:12px;
  padding:clamp(16px, 5vw, 32px);
  text-align:center;
  color:var(--text);
  max-width:90%;
  animation:slideUp .3s ease;
}

@keyframes slideUp{
  0%{opacity:0; transform:translateY(20px)}
  100%{opacity:1; transform:translateY(0)}
}

.modal-content h2{
  margin:0 0 8px 0;
  font-size:clamp(18px, 4vw, 24px);
  color:var(--accent);
}

.modal-content p{
  margin:0 0 16px 0;
  font-size:clamp(12px, 2.5vw, 14px);
  color:var(--muted);
}

.color-grid{
  display:grid;
  grid-template-columns:repeat(4, 1fr);
  gap:clamp(8px, 2vw, 12px);
}

.color-option{
  width:clamp(50px, 12vw, 70px);
  height:clamp(50px, 12vw, 70px);
  border:2px solid transparent;
  border-radius:8px;
  cursor:pointer;
  transition:transform .1s ease, border .1s ease;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
}

.color-option:hover{
  transform:scale(1.05);
  border-color:rgba(255,255,255,0.3);
}

.color-option:active{
  transform:scale(0.95);
}

/* ============ MINIMIZED COLOR PICKER BUTTON ============ */

.color-picker-button{
  display:none;
  position:fixed;
  top:clamp(8px, 2vw, 12px);
  right:clamp(8px, 2vw, 12px);
  width:clamp(36px, 8vw, 48px);
  height:clamp(36px, 8vw, 48px);
  border-radius:50%;
  border:2px solid rgba(255,255,255,0.2);
  cursor:pointer;
  z-index:100;
  transition:transform .1s ease;
  box-shadow:0 2px 8px rgba(0,0,0,0.4);
}

.color-picker-button:hover{
  transform:scale(1.1);
}

.color-picker-button:active{
  transform:scale(0.95);
}
